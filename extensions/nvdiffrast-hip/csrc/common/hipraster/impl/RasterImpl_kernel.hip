// !!! This is a file automatically generated by hipify!!!
#include "hip/hip_runtime.h"

// HIP/ROCm warp intrinsic compatibility macros
// CUDA uses _sync versions that HIP doesn't have
#ifndef __ballot_sync
#define __ballot_sync(mask, predicate) __ballot(predicate)
#endif
#ifndef __all_sync
#define __all_sync(mask, predicate) __all(predicate)
#endif
#ifndef __any_sync
#define __any_sync(mask, predicate) __any(predicate)
#endif
#ifndef __syncwarp
#define __syncwarp(...) __threadfence_block()
#endif

// Copyright (c) 2009-2022, NVIDIA CORPORATION.  All rights reserved.
//
// NVIDIA CORPORATION and its licensors retain all intellectual property
// and proprietary rights in and to this software, related documentation
// and any modifications thereto.  Any use, reproduction, disclosure or
// distribution of this software and related documentation without an express
// license agreement from NVIDIA CORPORATION is strictly prohibited.

#include "../../hipraster/CudaRaster.hpp"
#include "../../hipraster/impl/PrivateDefs.hpp"
#include "../../hipraster/impl/Constants.hpp"
#include "Util.inl"

namespace CR
{

//------------------------------------------------------------------------
// Stage implementations.
//------------------------------------------------------------------------

#include "TriangleSetup.inl"
#include "BinRaster.inl"
#include "CoarseRaster.inl"
#include "CoarseRasterSimple.inl"  // AMD HIP-compatible simplified version
#include "FineRaster.inl"

}

//------------------------------------------------------------------------
// Stage entry points.
//------------------------------------------------------------------------

__global__ void __launch_bounds__(CR_SETUP_WARPS * 32, CR_SETUP_OPT_BLOCKS)  triangleSetupKernel (const CR::CRParams p)  { CR::triangleSetupImpl(p); }
__global__ void __launch_bounds__(CR_BIN_WARPS * 32, 1)                      binRasterKernel     (const CR::CRParams p)  { CR::binRasterImpl(p); }
// AMD HIP FIX: Use simplified coarse raster that doesn't use warp-level sync
__global__ void __launch_bounds__(CR_COARSE_WARPS * 32, 1)                   coarseRasterKernel  (const CR::CRParams p)  { CR::coarseRasterImplSimple(p); }
__global__ void __launch_bounds__(CR_FINE_MAX_WARPS * 32, 1)                 fineRasterKernel    (const CR::CRParams p)  { CR::fineRasterImpl(p); }

//------------------------------------------------------------------------
